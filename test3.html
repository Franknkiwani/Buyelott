<!DOCTYPE html>
<html>
<head>
  <title>FCM Test</title>
</head>
<body>
  <button id="enable">Enable Notifications & Get Token</button>
  <pre id="output"></pre>

  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-messaging-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
      authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
      projectId: "itzhoyoo-f9f7e",
      messagingSenderId: "1094792075584",
      appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5"
    };

    firebase.initializeApp(firebaseConfig);

    const messaging = firebase.messaging();

    const enableBtn = document.getElementById('enable');
    const outputEl = document.getElementById('output');

    enableBtn.addEventListener('click', async () => {
      try {
        enableBtn.disabled = true;
        outputEl.textContent = 'Registering Service Worker...\n';
        await navigator.serviceWorker.register('/firebase-messaging-sw.js');
        outputEl.textContent += 'Service Worker registered.\nRequesting permission...\n';

        const permission = await Notification.requestPermission();
        if (permission !== 'granted') {
          outputEl.textContent += 'Notification permission denied.\n';
          enableBtn.disabled = false;
          return;
        }
        outputEl.textContent += 'Permission granted.\nGetting FCM token...\n';

        const token = await messaging.getToken({ vapidKey: 'YOUR_PUBLIC_VAPID_KEY_HERE' });
        outputEl.textContent += 'FCM Token:\n' + token;

      } catch (error) {
        outputEl.textContent += 'Error: ' + error.message;
      } finally {
        enableBtn.disabled = false;
      }
    });
  </script>
</body>
</html>