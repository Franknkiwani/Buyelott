<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SnapCash</title>
<script src="https://fpyf8.com/88/tag.min.js" data-zone="175875" async data-cfasync="false"></script>
<!-- Favicon -->
<link rel="icon" href="https://file.aiquickdraw.com/imgcompressed/img/compressed_11a96bfd99033a473cb9b6953f3f1555.webp" type="image/webp">

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
  authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
  databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
  projectId: "itzhoyoo-f9f7e",
  storageBucket: "itzhoyoo-f9f7e.filestorage.app",
  messagingSenderId: "1094792075584",
  appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
  measurementId: "G-LLT6F9WRKH"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

window.firebaseHelpers = {
  auth, db, provider,
  async getBalance(uid){
    const snap = await get(ref(db,'users/'+uid+'/balance'));
    return snap.exists()? snap.val():0;
  },
  async setBalance(uid,balance){
    await set(ref(db,'users/'+uid+'/balance'),balance);
  }
};
</script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;
-webkit-tap-highlight-color:transparent;}
body{background:#f0f0f0;color:#222;}

/* Header */
header{position:sticky;top:0;width:100%;background:rgba(255,255,255,0.6);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:space-between;padding:12px 24px;border-radius:0 0 16px 16px;border:2px solid #000;box-shadow:0 4px 20px rgba(0,0,0,0.15);z-index:1000;}
.logo{display:flex;align-items:center;gap:10px;}
.logo img{width:32px;height:32px;border-radius:4px;}
.app-name{font-size:1.25rem;font-weight:bold;color:#222;}
.header-controls{display:flex;align-items:center;gap:16px;}
.balance-btn{background:#27ae60;color:#fff;border:none;padding:8px 16px;border-radius:12px;font-weight:bold;cursor:pointer;transition: background 0.15s, transform 0.1s;}
.balance-btn:hover{background:#219150;}
.balance-btn:active{transform:scale(0.97);}
.profile{width:36px;height:36px;border-radius:50%;overflow:hidden;cursor:pointer;border:2px solid #000;}
.profile img{width:100%;height:100%;object-fit:cover;}

/* Main content */
main{padding:40px 20px 20px;display:flex;justify-content:center;}
.welcome-card{background:#fff;padding:40px 30px;border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,0.08);max-width:600px;text-align:center;backdrop-filter:blur(5px);}
.welcome-card h1{font-size:1.8rem;margin-bottom:15px;}
.welcome-card p{font-size:1rem;color:#555;line-height:1.5;}

/* Modals */
.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);backdrop-filter:blur(6px);display:none;justify-content:center;align-items:flex-start;padding-top:80px;z-index:2000;}
.modal{background: rgba(30,30,30,0.95);color:#fff;padding:30px 30px;border-radius:20px;width:90%;max-width:500px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.3);position:relative;}
.modal h2{margin-bottom:20px;}
.modal input, .modal select{width:100%;padding:12px;margin:10px 0;border-radius:12px;border:none;font-size:1rem;}
.modal input{background:#444;color:#fff;outline:none;}
.modal select{background:#222;color:#fff;}
.modal input:focus,.modal select:focus{box-shadow:0 0 0 2px #27ae60;}
.btn-group{display:flex;gap:10px;margin-top:20px;}
button{flex:1;padding:12px;border-radius:12px;border:none;cursor:pointer;font-weight:bold;font-size:1rem;transition:background 0.15s, transform 0.1s;}
button:active{transform:scale(0.97);}
.cashout-btn{background: rgba(39,174,96,0.8); color:#fff;}
.cashout-btn:hover{background: rgba(39,174,96,1);}
.cancel-btn{background: rgba(200,50,50,0.8); color:#fff;}
.cancel-btn:hover{background: rgba(200,50,50,1);}
.google-btn{background:#4285f4;color:#fff;}
.google-btn:hover{background:#357ae8;}

/* Messages */
.message-container{background:#fff;color:#000;padding:10px;border-radius:12px;margin-top:15px;display:none;font-weight:bold;}

/* Sidebar */
.sidebar{position:fixed;top:0;right:-250px;width:250px;height:100%;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);box-shadow:-4px 0 20px rgba(0,0,0,0.2);padding:20px;transition:right 0.3s;z-index:3000;border-left:2px solid #000;border-radius:0 0 0 16px;}
.sidebar.open{right:0;}
.sidebar h3{margin-bottom:20px;}
.sidebar a{display:block;margin:10px 0;color:#222;text-decoration:none;font-weight:bold;}
.sidebar a:hover{color:#27ae60;}
.sidebar .balance{margin:15px 0;font-weight:bold;font-size:1rem;}
.sidebar button{width:100%;margin-top:10px;padding:10px;border-radius:12px;border:none;color:#fff;font-weight:bold;cursor:pointer;transition:background 0.2s;}
#logoutBtn.login{background:#4285f4;} /* Blue when login */
#logoutBtn.logout{background:#c0392b;} /* Red when logout */
#logoutBtn.login:hover{background:#357ae8;}
#logoutBtn.logout:hover{background:#a83224;}
/* Main content */
main {
  padding: 40px 20px 20px;
  display: flex;
  justify-content: center;
}

.welcome-card {
  background: rgba(255, 255, 255, 0.65); /* Glass effect */
  backdrop-filter: blur(12px);
  padding: 40px 30px;
  border-radius: 20px;
  border: 2px solid #000; /* Black edges */
  box-shadow: 0 8px 20px rgba(0,0,0,0.2); /* Depth */
  max-width: 600px;
  text-align: center;
  animation: fadeIn 0.6s ease-in-out;
}

.welcome-card h1 {
  font-size: 2rem;
  margin-bottom: 15px;
  color: #111;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
}

.welcome-card p {
  font-size: 1.1rem;
  color: #333;
  line-height: 1.6;
}

/* Fade-in animation */
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(20px);}
  to {opacity: 1; transform: translateY(0);}
}
/* Upload Card */
.upload-card {
  margin-top: 25px;
  background: rgba(255,255,255,0.65);
  backdrop-filter: blur(12px);
  padding: 30px 20px;
  border-radius: 16px;
  border: 2px solid #000;
  box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  text-align: center;
}
.upload-card h2 { margin-bottom: 10px; color: #111; }
.upload-card input { display:block;margin:15px auto;padding:12px;
  border-radius:12px;border:2px solid #000;background:rgba(255,255,255,0.8);}
.upload-card button {
  background:#27ae60;color:#fff;border:none;padding:12px 20px;
  border-radius:12px;cursor:pointer;font-weight:bold;transition:background 0.15s;
}
.upload-card button:hover { background:#219150; }
.preview img {
  margin-top:15px;max-width:100%;border-radius:12px;border:2px solid #000;
}

/* Auth Modal Cleaned */
#authOverlay .modal {
  background: rgba(255,255,255,0.8);
  backdrop-filter: blur(12px);
  color:#111;
}
#authOverlay h2 { margin-bottom:20px; }
#authOverlay input {
  width:100%;padding:12px;margin:10px 0;border-radius:12px;
  border:2px solid #000;background:rgba(255,255,255,0.85);
  font-size:1rem;outline:none;
}
#authOverlay input:focus { box-shadow:0 0 0 2px #27ae60; }
#authOverlay .btn-group button {
  background:rgba(39,174,96,0.85);color:#fff;
}
#authOverlay .btn-group button.cancel-btn {
  background:rgba(200,50,50,0.8);
}
.google-btn {
  background:#fff !important;color:#444 !important;
  width:100%;margin-top:15px;border:2px solid #000;
  border-radius:12px;padding:12px;font-weight:bold;
}
.google-btn:hover { background:#f0f0f0 !important; }
</style>
</head>
<body>

<header>
  <div class="logo">
    <img src="https://file.aiquickdraw.com/imgcompressed/img/compressed_11a96bfd99033a473cb9b6953f3f1555.webp" alt="SnapCash Logo">
    <span class="app-name">SnapCash</span>
  </div>
  <div class="header-controls">
    <button class="balance-btn" id="balanceBtn">$0.000</button>
    <div class="profile" id="profilePic">
      <img src="https://picsum.photos/36" alt="Profile">
    </div>
  </div>
</header>

<main>
  <div class="welcome-card">
    <h1>SnapCash</h1>
    <p>Post your photos and earn money. Start sharing today!</p>
<!-- Upload Section -->
<div class="upload-card">
  <h2>Upload Your Photo</h2>
  <p>Share your photo and start earning!</p>
  <input type="file" id="photoUpload" accept="image/*">
  <button id="uploadBtn">Upload</button>
  <div class="preview" id="preview"></div>
  <div class="message-container" id="uploadMessage"></div>
</div>
</main>

<!-- Cashout Modal -->
<div class="modal-overlay" id="cashoutOverlay">
  <div class="modal">
    <h2>Cash Out</h2>
    <p id="balanceText">Your balance: $0.000</p>
    <select id="paymentMethod">
      <option value="">Select Payment Method</option>
      <option value="PayPal">PayPal</option>
      <option value="Bank">Bank Transfer</option>
      <option value="Crypto">Crypto Wallet</option>
    </select>
    <input type="text" id="paymentDetails" placeholder="Enter payment details">
    <div class="btn-group">
      <button class="cashout-btn" id="cashoutBtn">Cash Out</button>
      <button class="cancel-btn" id="cashoutCancel">Cancel</button>
    </div>
    <div class="message-container" id="cashoutMessage"></div>
  </div>
</div>

<!-- Login/Register Modal -->
<div class="modal-overlay" id="authOverlay">
  <div class="modal">
    <h2 id="authTitle">Login</h2>
    <input type="email" id="authEmail" placeholder="Email">
    <input type="password" id="authPassword" placeholder="Password">
    <div class="btn-group">
      <button class="cashout-btn" id="authSubmit">Login</button>
      <button class="cancel-btn" id="authCancel">Cancel</button>
    </div>
    <button class="google-btn" id="authGoogle">Sign in with Google</button>
    <p id="authSwitch" style="margin-top:10px;cursor:pointer;color:#27ae60;">Don't have an account? Register</p>
    <div class="message-container" id="authMessage"></div>
  </div>
</div>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
  <h3>Profile</h3>
  <div class="balance" id="sidebarBalance">Balance: $0.000</div>
  <a href="contacts.html" target="_blank">Contact Us</a>
  <a href="about.html" target="_blank">About Us</a>
  <button id="logoutBtn">Login</button>
</div>

<script type="module">
import { createUserWithEmailAndPassword, signInWithEmailAndPassword, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";

// Grab elements
const balanceBtn = document.getElementById('balanceBtn');
const cashoutOverlay = document.getElementById('cashoutOverlay');
const cashoutCancel = document.getElementById('cashoutCancel');
const cashoutBtn = document.getElementById('cashoutBtn');
const balanceText = document.getElementById('balanceText');
const paymentMethod = document.getElementById('paymentMethod');
const paymentDetails = document.getElementById('paymentDetails');
const cashoutMessage = document.getElementById('cashoutMessage');
const profilePic = document.getElementById('profilePic');
const sidebar = document.getElementById('sidebar');
const sidebarBalance = document.getElementById('sidebarBalance');
const authOverlay = document.getElementById('authOverlay');
const authTitle = document.getElementById('authTitle');
const authEmail = document.getElementById('authEmail');
const authPassword = document.getElementById('authPassword');
const authSubmit = document.getElementById('authSubmit');
const authCancel = document.getElementById('authCancel');
const authGoogle = document.getElementById('authGoogle');
const authSwitch = document.getElementById('authSwitch');
const authMessage = document.getElementById('authMessage');
const logoutBtn = document.getElementById('logoutBtn');

let isRegister = false;

function resetCashout(){ paymentMethod.value=''; paymentDetails.value=''; cashoutMessage.style.display='none'; }
function openSidebar(){ sidebar.classList.add('open'); }
function closeSidebar(){ sidebar.classList.remove('open'); }

async function updateBalances(){
  const user = window.firebaseHelpers.auth.currentUser;
  if(!user) return;
  const bal = await window.firebaseHelpers.getBalance(user.uid);
  balanceBtn.textContent=`$${bal.toFixed(3)}`;
  sidebarBalance.textContent=`Balance: $${bal.toFixed(3)}`;
}

// Auth state
window.firebaseHelpers.auth.onAuthStateChanged(async user=>{
  if(user){
    logoutBtn.textContent = "Logout";
    logoutBtn.classList.remove("login"); logoutBtn.classList.add("logout");
    if(user.photoURL){ profilePic.querySelector("img").src = user.photoURL; }
    authOverlay.style.display='none';
    await updateBalances();
  } else {
    logoutBtn.textContent = "Login";
    logoutBtn.classList.remove("logout"); logoutBtn.classList.add("login");
    profilePic.querySelector("img").src = "https://picsum.photos/36";
    balanceBtn.textContent = "$0.000"; sidebarBalance.textContent = "Balance: $0.000";
    authOverlay.style.display='flex';
  }
});

// Profile click
profilePic.addEventListener('click', ()=>{ 
  const user = window.firebaseHelpers.auth.currentUser;
  if(user) openSidebar(); else authOverlay.style.display='flex';
});

// Cashout
balanceBtn.addEventListener('click', async ()=>{
  const user = window.firebaseHelpers.auth.currentUser;
  if(!user){ authOverlay.style.display='flex'; return; }
  const bal = await window.firebaseHelpers.getBalance(user.uid);
  balanceText.textContent=`Your balance: $${bal.toFixed(3)}`;
  resetCashout();
  cashoutOverlay.style.display='flex';
});
cashoutCancel.addEventListener('click',()=>cashoutOverlay.style.display='none');
cashoutOverlay.addEventListener('click', e=>{if(e.target===cashoutOverlay) cashoutOverlay.style.display='none';});
cashoutBtn.addEventListener('click', async ()=>{
  const user = window.firebaseHelpers.auth.currentUser;
  if(!user) return;
  const bal = await window.firebaseHelpers.getBalance(user.uid);
  const method = paymentMethod.value, details = paymentDetails.value.trim();
  cashoutMessage.style.display='block';
  if(bal<10){ cashoutMessage.textContent='Minimum cash out is $10!'; cashoutMessage.style.color='red'; return; }
  if(!method){ cashoutMessage.textContent='Select a payment method!'; cashoutMessage.style.color='red'; return; }
  if(!details){ cashoutMessage.textContent='Enter payment details!'; cashoutMessage.style.color='red'; return; }
  cashoutMessage.textContent=`Cashed out $${bal.toFixed(3)} via ${method}`;
  cashoutMessage.style.color='green';
  await window.firebaseHelpers.setBalance(user.uid,0);
  updateBalances();
  setTimeout(()=>cashoutOverlay.style.display='none',1500);
});

// Logout/Login toggle
logoutBtn.addEventListener('click', async ()=>{
  const user = window.firebaseHelpers.auth.currentUser;
  if(user){ await signOut(window.firebaseHelpers.auth); closeSidebar(); }
  else { sidebar.classList.remove("open"); authOverlay.style.display="flex"; }
});

// Auth modal
authCancel.addEventListener('click',()=>authOverlay.style.display='none');
authSwitch.addEventListener('click',()=>{
  isRegister=!isRegister;
  if(isRegister){ authTitle.textContent="Register"; authSubmit.textContent="Register"; authSwitch.textContent="Already have an account? Login"; }
  else{ authTitle.textContent="Login"; authSubmit.textContent="Login"; authSwitch.textContent="Don't have an account? Register"; }
});
authSubmit.addEventListener('click', async ()=>{
  const email=authEmail.value.trim(), pass=authPassword.value.trim();
  if(!email||!pass){ authMessage.style.display='block'; authMessage.textContent="Fill in all fields!"; authMessage.style.color="red"; return; }
  try{
    let userCred;
    if(isRegister){ userCred=await createUserWithEmailAndPassword(window.firebaseHelpers.auth,email,pass); await window.firebaseHelpers.setBalance(userCred.user.uid,0);}
    else{ userCred=await signInWithEmailAndPassword(window.firebaseHelpers.auth,email,pass);}
    authMessage.style.display='block'; authMessage.textContent=isRegister?"Registered successfully!":"Logged in!"; authMessage.style.color="green";
    setTimeout(()=>authOverlay.style.display='none',1000); updateBalances();
  }catch(err){ authMessage.style.display='block'; authMessage.textContent=err.message; authMessage.style.color="red";}
});
authGoogle.addEventListener('click', async ()=>{
  try{
    const result=await signInWithPopup(window.firebaseHelpers.auth, window.firebaseHelpers.provider);
    const user=result.user; const bal=await window.firebaseHelpers.getBalance(user.uid);
    if(bal===0){ await window.firebaseHelpers.setBalance(user.uid,0); }
    authOverlay.style.display='none'; updateBalances();
  }catch(err){ authMessage.style.display='block'; authMessage.textContent=err.message; authMessage.style.color="red"; }
});

// Close sidebar when clicking outside
document.addEventListener('click', e=>{
  if(sidebar.classList.contains('open') && !sidebar.contains(e.target) && !profilePic.contains(e.target)){ closeSidebar(); }
});
const uploadBtn = document.getElementById("uploadBtn");
const uploadMessage = document.getElementById("uploadMessage");

uploadBtn.addEventListener("click", async ()=>{
  const file = photoUpload.files[0];
  const user = window.firebaseHelpers.auth.currentUser;

  uploadMessage.style.display="block";
  uploadMessage.style.color="red";

  if(!user){
    uploadMessage.textContent="You must be logged in to upload!";
    return;
  }
  if(!file){
    uploadMessage.textContent="Select a photo first!";
    return;
  }

  try {
    // Upload to Imgur
    const formData = new FormData();
    formData.append("image", file);

    const res = await fetch("https://api.imgur.com/3/image", {
      method: "POST",
      headers: { Authorization: "Client-ID 891e5bb4aa94282" },
      body: formData
    });
    const data = await res.json();

    if(!data.success){
      uploadMessage.textContent="Imgur upload failed!";
      return;
    }

    const imageUrl = data.data.link;

    // Save to Firebase (under user uploads)
    const userId = user.uid;
    const uploadsRef = ref(window.firebaseHelpers.db, `users/${userId}/uploads/${Date.now()}`);
    await set(uploadsRef, { url: imageUrl, timestamp: Date.now() });

    // Reward user (add $0.05 per upload for example)
    const currentBal = await window.firebaseHelpers.getBalance(userId);
    await window.firebaseHelpers.setBalance(userId, currentBal + 0.05);
    updateBalances();

    uploadMessage.textContent="Upload successful! +$0.05 added 🎉";
    uploadMessage.style.color="green";
    preview.innerHTML = `<img src="${imageUrl}" alt="Uploaded">`;

  } catch(err){
    uploadMessage.textContent="Error: " + err.message;
  }
});
</script>
</body>
</html>