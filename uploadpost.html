<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Loading & Auth Check</title>
<style>
  /* Basic Reset */
  body, html {
    margin: 0; padding: 0; height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    overflow: hidden; /* prevent scroll until auth checked */
    background: #000; /* black bg */
  }

  /* Loading screen */
  #loadingScreen {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
  }
  /* Simple gamer spinner: layered circles */
  .spinner {
    width: 60px;
    height: 60px;
    border: 6px solid transparent;
    border-top-color: #00ff99;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    position: relative;
  }
  .spinner::before {
    content: "";
    position: absolute;
    top: 12px; left: 12px;
    width: 36px; height: 36px;
    border: 4px solid #0f0;
    border-bottom-color: transparent;
    border-radius: 50%;
    animation: spinReverse 0.7s linear infinite;
  }
  @keyframes spin {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(360deg);}
  }
  @keyframes spinReverse {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(-360deg);}
  }

  /* Overlay behind popup */
  #overlay {
    display: none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background-color: rgba(0,0,0,0.8);
    z-index: 9998;
  }

  /* Popup container */
  #loginPopup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #111;
    border-radius: 20px;
    width: 280px;
    padding: 20px;
    color: #0f0;
    box-shadow: 0 0 20px #00ff99;
    z-index: 9999;
    text-align: center;
    user-select: none;
  }
  #loginPopup.show {
    display: block;
  }

  #loginPopup h2 {
    margin-bottom: 15px;
    font-weight: 700;
    font-size: 20px;
  }

  #loginPopup p {
    margin-bottom: 20px;
    font-size: 16px;
  }

  #loginNowBtn {
    background: #00ff99;
    border: none;
    color: #000;
    padding: 12px 30px;
    font-weight: 700;
    border-radius: 12px;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s ease;
  }
  #loginNowBtn:hover {
    background: #00cc77;
  }
</style>
</head>
<body>

<!-- Loading Screen -->
<div id="loadingScreen">
  <div class="spinner"></div>
</div>

<!-- Overlay -->
<div id="overlay"></div>

<!-- Login Popup -->
<div id="loginPopup" role="dialog" aria-modal="true" aria-labelledby="popupTitle" aria-describedby="popupDesc">
  <h2 id="popupTitle">You Are Not Logged In</h2>
  <p id="popupDesc">Please login to continue using this app.</p>
  <button id="loginNowBtn">Login Now</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
    authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
    databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
    projectId: "itzhoyoo-f9f7e",
    storageBucket: "itzhoyoo-f9f7e.appspot.com",
    messagingSenderId: "1094792075584",
    appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
    measurementId: "G-LLT6F9WRKH"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const loadingScreen = document.getElementById('loadingScreen');
  const loginPopup = document.getElementById('loginPopup');
  const loginNowBtn = document.getElementById('loginNowBtn');
  const overlay = document.getElementById('overlay');

  // Keep body scroll disabled until auth state resolved
  document.body.style.overflow = 'hidden';

  onAuthStateChanged(auth, (user) => {
    loadingScreen.style.display = 'none';

    if (user) {
      // Logged in -> hide popup & overlay, enable scroll
      loginPopup.classList.remove('show');
      overlay.style.display = 'none';
      document.body.style.overflow = 'auto';
      console.log("User logged in:", user.uid);
    } else {
      // NOT logged in -> show popup & overlay, keep scroll locked
      loginPopup.classList.add('show');
      overlay.style.display = 'block';
      console.log("User not logged in.");

      // Optional: auto redirect to login.html after 10 seconds
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 10000);
    }
  });

  loginNowBtn.addEventListener('click', () => {
    window.location.href = 'login.html';
  });
</script>

<style>
  /* Basic Reset */
  body, html {
    margin: 0; padding: 0; height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    overflow: hidden; /* prevent scroll until auth checked */
    background: #000; /* black bg */
  }

  /* Loading screen */
  #loadingScreen {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
  }
  /* Simple gamer spinner: layered circles */
  .spinner {
    width: 60px;
    height: 60px;
    border: 6px solid transparent;
    border-top-color: #00ff99;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    position: relative;
  }
  .spinner::before {
    content: "";
    position: absolute;
    top: 12px; left: 12px;
    width: 36px; height: 36px;
    border: 4px solid #0f0;
    border-bottom-color: transparent;
    border-radius: 50%;
    animation: spinReverse 0.7s linear infinite;
  }
  @keyframes spin {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(360deg);}
  }
  @keyframes spinReverse {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(-360deg);}
  }

  /* Overlay behind popup */
  #overlay {
    display: none;
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background-color: rgba(0,0,0,0.8);
    z-index: 9998;
  }

  /* Popup container */
  #loginPopup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #111;
    border-radius: 20px;
    width: 280px;
    padding: 20px;
    color: #0f0;
    box-shadow: 0 0 20px #00ff99;
    z-index: 9999;
    text-align: center;
    user-select: none;
  }
  #loginPopup.show {
    display: block;
  }

  #loginPopup h2 {
    margin-bottom: 15px;
    font-weight: 700;
    font-size: 20px;
  }

  #loginPopup p {
    margin-bottom: 20px;
    font-size: 16px;
  }

  #loginNowBtn {
    background: #00ff99;
    border: none;
    color: #000;
    padding: 12px 30px;
    font-weight: 700;
    border-radius: 12px;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s ease;
  }
  #loginNowBtn:hover {
    background: #00cc77;
  }
</style>
</head>
<body>

<!-- Loading Screen -->
<div id="loadingScreen">
  <div class="spinner"></div>
</div>

<!-- Overlay -->
<div id="overlay"></div>

<!-- Login Popup -->
<div id="loginPopup" role="dialog" aria-modal="true" aria-labelledby="popupTitle" aria-describedby="popupDesc">
  <h2 id="popupTitle">You Are Not Logged In</h2>
  <p id="popupDesc">Please login to continue using this app.</p>
  <button id="loginNowBtn">Login Now</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
    authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
    databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
    projectId: "itzhoyoo-f9f7e",
    storageBucket: "itzhoyoo-f9f7e.appspot.com",
    messagingSenderId: "1094792075584",
    appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
    measurementId: "G-LLT6F9WRKH"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const loadingScreen = document.getElementById('loadingScreen');
  const loginPopup = document.getElementById('loginPopup');
  const loginNowBtn = document.getElementById('loginNowBtn');
  const overlay = document.getElementById('overlay');

  // Keep body scroll disabled until auth state resolved
  document.body.style.overflow = 'hidden';

  onAuthStateChanged(auth, (user) => {
    loadingScreen.style.display = 'none';

    if (user) {
      // Logged in -> hide popup & overlay, enable scroll
      loginPopup.classList.remove('show');
      overlay.style.display = 'none';
      document.body.style.overflow = 'auto';
      console.log("User logged in:", user.uid);
    } else {
      // NOT logged in -> show popup & overlay, keep scroll locked
      loginPopup.classList.add('show');
      overlay.style.display = 'block';
      console.log("User not logged in.");

      // Optional: auto redirect to login.html after 10 seconds
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 10000);
    }
  });

  loginNowBtn.addEventListener('click', () => {
    window.location.href = 'login.html';
  });
</script>
</body>
</html>