<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WATCH-4-RBX</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,'SF Pro',sans-serif;}
body{background:#0a0a0a;color:#fff;height:100vh;}

header{
  position:sticky;top:0;
  padding:12px 20px;
  display:flex;justify-content:space-between;align-items:center;
  backdrop-filter:blur(20px);
  background:rgba(255,255,255,0.05);
  border-bottom:1px solid rgba(255,255,255,0.1);
}

.left{display:flex;align-items:center;gap:10px;}
.left img{width:26px;height:26px;}
.left h1{font-size:1.2rem;}

.loading,.rbx,.register-btn{
  padding:8px 16px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.3);
}

.register-btn{
  background:rgba(255,255,255,.12);
  cursor:pointer;
  font-weight:600;
}

.user-actions{
  display:flex;
  align-items:center;
  gap:10px;
  position:relative;
}

.logout-icon{
  width:22px;
  height:22px;
  cursor:pointer;
  fill:#ff4d4d;
}

.logout-menu{
  display:none;
  position:absolute;
  right:0;
  top:120%;
  background:#120000;
  border:1px solid rgba(255,77,77,.6);
  border-radius:12px;
  padding:6px;
  box-shadow:0 0 15px rgba(255,77,77,.4);
}

.logout-menu button{
  background:none;
  border:none;
  color:#ff4d4d;
  font-weight:700;
  padding:8px 16px;
  border-radius:10px;
  cursor:pointer;
}

.logout-menu button:hover{background:rgba(255,77,77,.15);}

/* MODAL */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  backdrop-filter:blur(15px);
  z-index:200;
  justify-content:center;
  align-items:center;
}

.modal-box{
  width:90%;
  max-width:420px;
  background:#0f0f0f;
  border-radius:18px;
  padding:20px;
}

.balance-big{text-align:center;font-size:2.2rem;font-weight:800;}
.sub{text-align:center;opacity:.7;margin-bottom:10px;}
.notice{text-align:center;font-size:.85rem;margin-bottom:15px;}

input,textarea{
  width:100%;
  background:#000;
  border:1px solid rgba(255,255,255,.2);
  border-radius:10px;
  padding:10px;
  color:#fff;
  margin-bottom:10px;
}

textarea{resize:none;height:70px;}

.confirm{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  background:#fff;
  color:#000;
}

.msg{text-align:center;margin-top:10px;font-weight:600;}
.error{color:#ff4d4d;}
.success{color:#00ff99;}

.history{margin-top:15px;font-size:.85rem;opacity:.8;}
</style>
</head>

<body>

<header>
  <div class="left">
    <img src="https://img.icons8.com/ios-filled/50/ffffff/robux.png">
    <h1>WATCH-4-RBX</h1>
  </div>
  <div id="headerRight"><div class="loading">Loadingâ€¦</div></div>
</header>

<!-- WITHDRAW MODAL -->
<div class="modal" id="withdrawModal">
  <div class="modal-box">
    <div class="balance-big" id="bigBal">0 RBX</div>
    <div class="sub">Available balance</div>

    <div class="notice">
      Once you reach <b>150 RBX</b>, you can redeem for real Robux
    </div>

    <input id="robloxUser" placeholder="@roblox username">
    <textarea id="extraInfo" placeholder="More info (optional)"></textarea>

    <button class="confirm" onclick="confirmWithdraw()">CONFIRM</button>
    <div class="msg" id="msg"></div>

    <div class="history" id="history"></div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";
import { getDatabase, ref, get, push } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
  authDomain:"itzhoyoo-f9f7e.firebaseapp.com",
  databaseURL:"https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
  projectId:"itzhoyoo-f9f7e",
  storageBucket:"itzhoyoo-f9f7e.filestorage.app",
  messagingSenderId:"1094792075584",
  appId:"1:1094792075584:web:d49e9c3f899d3cd31082a5"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getDatabase(app);

let currentUser,balance=0;
const headerRight=document.getElementById("headerRight");

window.openModal=()=>document.getElementById("withdrawModal").style.display="flex";
window.toggleLogout=()=>document.getElementById("logoutMenu").style.display="block";
window.doLogout=async()=>{await signOut(auth);location.reload();};

onAuthStateChanged(auth,async user=>{
  if(!user){
    headerRight.innerHTML=`<button class="register-btn">REGISTER</button>`;
    return;
  }
  currentUser=user;
  const balSnap=await get(ref(db,`users/${user.uid}/rbxbalance`));
  balance=balSnap.exists()?balSnap.val():0;
  document.getElementById("bigBal").innerText=balance+" RBX";

  headerRight.innerHTML=`
    <div class="user-actions">
      <div class="rbx" onclick="openModal()">${balance} RBX / GET</div>
      <svg class="logout-icon" onclick="toggleLogout()" viewBox="0 0 24 24">
        <path d="M12 2a10 10 0 100 20 10 10 0 000-20z"/>
      </svg>
      <div class="logout-menu" id="logoutMenu">
        <button onclick="doLogout()">Logout</button>
      </div>
    </div>`;
});

window.confirmWithdraw=async()=>{
  const msg=document.getElementById("msg");
  msg.className="msg";
  if(balance<150){
    msg.textContent="You need at least 150 RBX";
    msg.classList.add("error");
    return;
  }
  await push(ref(db,`confirmedrbx/${currentUser.uid}`),{
    amount:150,
    roblox:robloxUser.value,
    info:extraInfo.value,
    status:"pending",
    time:Date.now()
  });
  msg.textContent="Withdrawal submitted";
  msg.classList.add("success");
};
</script>

</body>
</html>