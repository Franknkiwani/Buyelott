<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YouTube Channel Lite Analytics</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: #121212;
      color: #eee;
      max-width: 480px;
      margin: auto;
      padding: 1rem;
    }
    h1 {
      color: #0ff;
      text-align: center;
      margin-bottom: 1rem;
    }
    form {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    input[type="text"] {
      flex: 1;
      padding: 0.7rem;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
      outline-offset: 2px;
    }
    button {
      background: #0ff;
      color: #121212;
      font-weight: bold;
      padding: 0.7rem 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1rem;
      transition: background 0.2s;
    }
    button:hover {
      background: #0cc;
    }
    #results {
      background: #222;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 0 12px #0ff33a44;
      min-height: 100px;
    }
    .label {
      font-weight: 600;
      margin-top: 0.5rem;
      color: #0f0;
    }
    .value {
      font-size: 1.3rem;
      font-weight: 700;
      margin-top: 0.2rem;
    }
    .error {
      color: #f33;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <h1>YouTube Channel Lite Analytics</h1>
  <form id="channelForm">
    <input
      type="text"
      id="channelInput"
      placeholder="Enter channel URL, ID or @handle"
      required
      autocomplete="off"
      spellcheck="false"
    />
    <button type="submit">Check</button>
  </form>
  <div id="results" aria-live="polite"></div>

  <script>
    function extractChannelId(input) {
      try {
        const url = new URL(input);
        const path = url.pathname.split("/").filter(Boolean);
        // Support @handle URLs
        if (path[0] && path[0].startsWith("@")) return path[0];
        if (path[0] === "channel") return path[1];
        if (path[0] === "user" || path[0] === "c") return path[1];
        return null;
      } catch {
        return input;
      }
    }

    async function fetchChannelMobileHtml(channelId) {
      let url = "";
      if (channelId.startsWith("@")) {
        url = `https://m.youtube.com/${channelId}`;
      } else {
        url = `https://m.youtube.com/channel/${channelId}`;
      }
      const res = await fetch(url, { mode: "cors" });
      if (!res.ok) throw new Error("Failed to fetch channel page");
      return res.text();
    }

    function parseChannelStats(html) {
      // Attempt to parse subscriber count (could be like "1.2M subscribers" or "No subscribers")
      const subMatch = html.match(/"subscriberCountText":{"simpleText":"([^"]+) subscribers"}/);
      // Video count appears like "123 videos"
      const videoMatch = html.match(/"videoCountText":{"runs":\[{"text":"([\d,]+) videos?"}\]/);
      // Channel name from title tag: "ChannelName - YouTube"
      const nameMatch = html.match(/<title>([^<]+)<\/title>/);

      const subscriberCount = subMatch ? subMatch[1] : "N/A";
      const videoCount = videoMatch ? videoMatch[1] : "N/A";
      const channelName = nameMatch ? nameMatch[1].replace(" - YouTube", "") : "N/A";

      return { subscriberCount, videoCount, channelName };
    }

    document.getElementById("channelForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const input = document.getElementById("channelInput").value.trim();
      if (!input) return;

      const resultsDiv = document.getElementById("results");
      resultsDiv.textContent = "Fetching data...";

      const channelId = extractChannelId(input);
      if (!channelId) {
        resultsDiv.innerHTML = `<p class="error">Invalid channel URL, ID, or handle.</p>`;
        return;
      }

      try {
        const html = await fetchChannelMobileHtml(channelId);
        const stats = parseChannelStats(html);

        resultsDiv.innerHTML = `
          <div><span class="label">Channel Name:</span> <span class="value">${stats.channelName}</span></div>
          <div><span class="label">Subscribers:</span> <span class="value">${stats.subscriberCount}</span></div>
          <div><span class="label">Total Videos:</span> <span class="value">${stats.videoCount}</span></div>
        `;
      } catch (err) {
        resultsDiv.innerHTML = `<p class="error">Error fetching or parsing data: ${err.message}</p>`;
      }
    });
  </script>
</body>
</html>