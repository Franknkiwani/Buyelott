<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hoyoo Tasks</title>
<style>
  body {background:#111;color:#fff;font-family:-apple-system, BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;padding:20px;}
  h1 {text-align:center;margin-bottom:20px;}
  .task-card {background:#1f1f1f;padding:20px;margin:15px auto;border-radius:12px;max-width:400px;text-align:center;border:1px solid #fff;}
  .task-card button {padding:12px 20px;border:none;border-radius:10px;background:#00bc6e;color:#fff;font-weight:600;cursor:pointer;margin-top:10px;}
  .task-card button:disabled {background:#555;cursor:not-allowed;}
  #balance {text-align:center;font-size:24px;margin-bottom:20px;}
</style>
</head>
<body>

<h1>Earn Money</h1>
<div id="balance">Balance: $0.00</div>

<div class="task-card">
  <h2>Click to Earn</h2>
  <p>Click the button to earn <strong>$0.001</strong></p>
  <button id="clickEarnBtn">Click & Earn</button>
</div>

<div class="task-card">
  <h2>Watch & Earn</h2>
  <p>Watch a short ad to earn <strong>$0.010</strong></p>
  <button id="watchEarnBtn">Watch & Earn</button>
</div>

<div class="task-card">
  <h2>Daily Check-in</h2>
  <p>Check in once every 24 hours to earn <strong>$0.100</strong></p>
  <button id="dailyCheckBtn">Daily Check-in</button>
  <p id="dailyHint" style="font-size:12px;margin-top:6px;"></p>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDFHskUWiyHhZke3KT9kkOtFI_gPsKfiGo",
  authDomain: "itzhoyoo-f9f7e.firebaseapp.com",
  databaseURL: "https://itzhoyoo-f9f7e-default-rtdb.firebaseio.com",
  projectId: "itzhoyoo-f9f7e",
  storageBucket: "itzhoyoo-f9f7e.filestorage.app",
  messagingSenderId: "1094792075584",
  appId: "1:1094792075584:web:d49e9c3f899d3cd31082a5",
  measurementId: "G-LLT6F9WRKH"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let user = null;
let balance = 0;

// Utility
function formatUSD(v){ return '$'+Number(v).toFixed(3); }
function refreshBalance(){ document.getElementById('balance').textContent = 'Balance: '+formatUSD(balance); }

// Load user's current balance
function loadBalance(uid){
  db.ref('myearnings/'+uid).get().then(snapshot=>{
    if(snapshot.exists()){
      const data = snapshot.val();
      balance = data.balance || 0;
      refreshBalance();
    } else {
      db.ref('myearnings/'+uid).set({balance:0, pending:0, withdrawn:0, nextPayout:'-'});
      balance = 0;
      refreshBalance();
    }
  });
}

// Auth check
auth.onAuthStateChanged(u=>{
  if(u){
    user = u;
    loadBalance(user.uid);
  } else {
    alert('You must be logged in to earn money!');
  }
});

// Click to earn
document.getElementById('clickEarnBtn').addEventListener('click', ()=>{
  if(!user) return alert('Login first');
  balance += 0.001;
  refreshBalance();
  db.ref('myearnings/'+user.uid).update({balance:balance});
});

// Watch & Earn
document.getElementById('watchEarnBtn').addEventListener('click', ()=>{
  if(!user) return alert('Login first');
  // Simulate ad watch delay
  const btn = document.getElementById('watchEarnBtn');
  btn.disabled = true;
  btn.textContent = 'Watching ad...';
  setTimeout(()=>{
    balance += 0.01;
    refreshBalance();
    db.ref('myearnings/'+user.uid).update({balance:balance});
    btn.disabled = false;
    btn.textContent = 'Watch & Earn';
  }, 5000); // 5s ad
});

// Daily check-in
document.getElementById('dailyCheckBtn').addEventListener('click', ()=>{
  if(!user) return alert('Login first');
  const today = new Date().getTime();
  db.ref('tasks/'+user.uid+'/dailyCheck').get().then(snap=>{
    let lastCheck = snap.val() || 0;
    if(today - lastCheck >= 24*60*60*1000){
      balance += 0.1;
      refreshBalance();
      db.ref('myearnings/'+user.uid).update({balance:balance});
      db.ref('tasks/'+user.uid+'/dailyCheck').set(today);
      document.getElementById('dailyHint').textContent = 'Daily check-in successful!';
    } else {
      document.getElementById('dailyHint').textContent = 'Already checked in within 24 hours.';
    }
  });
});
</script>

</body>
</html>